---
title: "FINAL_mirror-exp_wild-pop"
author: "Allison Davis"
date: "November 19, 2019"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Data collection

  * raw data: occurance number and preference score for each individual fish (left, right, NA)
  * pref data: preference scores for tank A, B, combo of A and B, and average of A and B
      - combo score determined as left/(left+right) for total left and right occurances
      - average score determined by averaging tank A pref score and tank B pref score
  * separated all data by species
  * original analyses w/20 individuals showed a significant difference between using the TOT.PROP vs AVG.PROP for latipinna only; for all tests, will repeat with AVG.PROP to see if this changes the results
    + <font color ="darkorchid4"> Tests includind AVG.PROP in place of TOT.PROP don't really change the values of the statistical tests. Will coninue with TOT.PROP.</font>

```{r echo=FALSE}
library(curl)

rawRE <- curl("https://raw.githubusercontent.com/allisondavis/mirror-exp_wild-pop/master/adavis_mirror-exp_wild-pop_rescored-raw.csv")

rawRE <- read.csv(rawRE, header = TRUE, sep = ",", stringsAsFactors = TRUE)

prefRE <- curl("https://raw.githubusercontent.com/allisondavis/mirror-exp_wild-pop/master/adavis_mirror-exp_wild-pop_rescored-props_common.csv")

prefRE <- read.csv(prefRE, header = TRUE, sep = ",", stringsAsFactors = TRUE)


#I will separate out the sexual vs asexual 

p_form.rawRE <- rawRE[rawRE$X.U.FEFF.SPP =="P.form",]

p_lat.rawRE <- rawRE[rawRE$X.U.FEFF.SPP == "P.lat",]

p_formRE <- prefRE[prefRE$X.U.FEFF.SPP== "Amazon",]


p_latRE <- prefRE[prefRE$X.U.FEFF.SPP== "Sailfin",]

```

### Analyses {.tabset .tabset-fade .tabset-pills}

#### More fish

Data

```{r}
library(curl)

rawEX <- curl("https://raw.githubusercontent.com/allisondavis/mirror-exp_wild-pop/master/adavis_mirexp_wild_raw.csv")

rawEX <- read.csv(rawEX, header = TRUE, sep = ",", stringsAsFactors = TRUE)

LAT_rawEX <- rawEX[rawEX$X.U.FEFF.SPP == "P.lat",]
FORM_rawEX <- rawEX[rawEX$X.U.FEFF.SPP == "P.form",]

tanksEX <- curl("https://raw.githubusercontent.com/allisondavis/mirror-exp_wild-pop/master/adavis_mirexp_wild_tanks.csv")

tanksEX <- read.csv(tanksEX, header = TRUE, sep = ",", stringsAsFactors = TRUE)

LAT_tankEX <- tanksEX[tanksEX$X.U.FEFF.SPP == "P.lat",]
FORM_tankEX <- tanksEX[tanksEX$X.U.FEFF.SPP == "P.form",]

```

Overview

```{r, warning=FALSE}
library(ggplot2)
library(ggsignif)
library(gridExtra)
library(ggthemes)

orig2 <- ggplot(rawEX, aes(x=X.U.FEFF.SPP, y=LI.TOT)) + geom_boxplot() + geom_point(color="gray75") + xlab("Species") + ylab("Laterality index") + ggtitle("Original Data") + theme_classic()

orig2

```


Outlier tests

```{r, warning=FALSE}
library(DescTools)

Outlier(LAT_rawEX$LI.TOT, method=c("boxplot"), value = FALSE)

Outlier(FORM_rawEX$LI.TOT, method=c("boxplot"), value = FALSE)

```

* Still no outliers for sailfin; four outliers for amazon (Cayenne, Gretchen, Sofia, Nyx)

New Datasets

```{r}
FORM_rawextra <- FORM_rawEX[-c(3,11,19,23),]
FORM_tankextra <- FORM_tankEX[-c(5,6,21,22,37,38,47,48),]

rawextra <- rbind(LAT_rawEX, FORM_rawextra)
tankextra <- rbind(LAT_tankEX, FORM_tankextra)

```

Overview with outlier removed

```{r, warning=FALSE}
library(ggplot2)
library(ggsignif)
library(gridExtra)
library(ggthemes)


rem_out2 <- ggplot(rawextra, aes(x=X.U.FEFF.SPP, y=LI.TOT)) + geom_boxplot() + geom_point(color="gray75") + xlab("Species") + ylab("Laterality index") + ggtitle("Outlier-Removed Data") + theme_classic()

rem_out2
orig2

grid.arrange(orig2, rem_out2, ncol=2)

```


Wilcox tests

* tank differences: none

```{r}
wilcox.test(PROP~TANK, data = tankextra, paired=TRUE, conf.int=TRUE, conf.level=0.95)
wilcox.test(PROP~TANK, data = LAT_tankEX, paired=TRUE, conf.int=TRUE, conf.level=0.95)
wilcox.test(PROP~TANK, data = FORM_tankextra, paired=TRUE, conf.int=TRUE, conf.level=0.95)

#using laterality index instead
wilcox.test(LI.TOT~TANK, data = LAT_tankEX, paired=TRUE, conf.int=TRUE, conf.level=0.95)
wilcox.test(LI.TOT~TANK, data = FORM_tankextra, paired=TRUE, conf.int=TRUE, conf.level=0.95)
wilcox.test(LI.TOT~TANK, data = FORM_tankEX, paired=TRUE, conf.int=TRUE, conf.level=0.95)


```


* eye preferences: none for sailfin; 0.025 p for amazon 

```{r}
wilcox.test(LAT_rawEX$TOT.PROP, mu=0.5, alternative = "two.sided", conf.int=TRUE, conf.level=0.95)
wilcox.test(LAT_rawEX$LI.TOT, mu=0, alternative = "two.sided", conf.int=TRUE, conf.level=0.95)

wilcox.test(FORM_rawextra$TOT.PROP, mu=0.5, alternative = "two.sided", conf.int=TRUE, conf.level=0.95)
wilcox.test(FORM_rawextra$LI.TOT, mu=0, alternative = "two.sided", conf.int=TRUE, conf.level=0.95)

```


* eye differences: none

```{r}
wilcox.test(TOT.PROP~X.U.FEFF.SPP, data = rawextra, paired=FALSE, alternative = "two.sided", conf.int=TRUE, conf.level=0.95)

wilcox.test(LI.TOT~X.U.FEFF.SPP, data = rawextra, paired=FALSE, alternative = "two.sided", conf.int=TRUE, conf.level=0.95)

```

* overall laterality 

```{r}

totLAT <- abs(LAT_rawEX$LI.TOT)
totFORM <- abs(FORM_rawextra$LI.TOT)

wilcox.test(totLAT, totFORM, paired = FALSE, alternative = "two.sided", conf.int = TRUE, conf.level = 0.95)


```


T- tests using LI instead of total proportion

* tank differences: still none

```{r}

t.test(LAT_rawEX$LI.A, LAT_rawEX$LI.B, paired = TRUE, alternative = "two.sided")

t.test(FORM_rawextra$LI.A, FORM_rawextra$LI.B, paired = TRUE, alternative = "two.sided")


```


* eye preferences: sailfin still no pref, amazon with pretty much no pref (p=0.055)

```{r}

t.test(LAT_rawEX$LI.TOT, mu=0, alternative = "two.sided")

t.test(FORM_rawextra$LI.TOT, mu=0, alternative = "two.sided")


```


* differences between spp: no differences

```{r}

t.test(LAT_rawEX$LI.TOT, FORM_rawextra$LI.TOT)

```


* Variance: still significant

```{r}
var.test(LAT_rawEX$LI.TOT, FORM_rawextra$LI.TOT, alternative = "two.sided")

```



Transformations

 * transform the data WITH LAT INDEX

```{r}

PL_trans3 <- transform(LAT_rawEX, arcTOT = asin(LAT_rawEX$LI.TOT))

PF_trans3 <- transform(FORM_rawextra, arcTOT = asin(FORM_rawextra$LI.TOT))

```


  * variance WITH LAT INDEX: p is .007

```{r}

var.test(PL_trans3$LI.TOT, PF_trans3$LI.TOT, alternative = "two.sided")

var.test(PL_trans3$LI.TOT, PF_trans3$LI.TOT, alternative = "greater")

var.test(PL_trans3$LI.TOT, PF_trans3$LI.TOT, alternative = "less")


```

 
 
   * transform the data

```{r}

PL_transA2 <- transform(LAT_rawEX, arcA = asin(LAT_rawEX$A.PROP))

PF_transA2 <- transform(FORM_rawextra, arcA = asin(FORM_rawextra$A.PROP))


PL_transB2 <- transform(LAT_rawEX, arcB = asin(LAT_rawEX$B.PROP))

PF_transB2 <- transform(FORM_rawextra, arcB = asin(FORM_rawextra$B.PROP))


PL_trans2 <- transform(LAT_rawEX, arcTOT = asin(LAT_rawEX$TOT.PROP))

PF_trans2 <- transform(FORM_rawextra, arcTOT = asin(FORM_rawextra$TOT.PROP))

```

  * t-tests: tank differences - still none

```{r}

t.test(PL_transA2$arcA, PL_transB2$arcB, paired = TRUE, alternative = "two.sided")

t.test(PF_transA2$arcA, PF_transB2$arcB, paired = TRUE, alternative = "two.sided")


```


 
  * t-tests: eye preference- still none for sailfin; amazon p is 0.5 with mean in CI

```{r}

t.test(PL_trans2$TOT.PROP, mu=0.5, alternative = "two.sided")

t.test(PF_trans2$TOT.PROP, mu=0.5, alternative = "two.sided")


```



  * t-tests: comparing species -still no difference

```{r}

t.test(PL_trans2$TOT.PROP, PF_trans2$TOT.PROP)


```



  * variance: p is .007

```{r}

var.test(PL_trans2$TOT.PROP, PF_trans2$TOT.PROP, alternative = "two.sided")

var.test(PL_trans2$TOT.PROP, PF_trans2$TOT.PROP, alternative = "greater")

var.test(PL_trans2$TOT.PROP, PF_trans2$TOT.PROP, alternative = "less")


```



#### Outlier tests

Histogram shows what appear to be outliers in both species. Will now perform a Tukey's outlier test to see if they are in fact outlier, and if removing these outliers changes the variance between species.

```{r echo=FALSE}

library(DescTools)

Outlier(p_latRE$TOT.PROP, method=c("boxplot"), value = FALSE)

#repeat for avg.prop --> STILL NO OUTLIERS

Outlier(p_latRE$AVG.PROP, method=c("boxplot"), value = FALSE)


```

* Sailfin: no outliers

```{r echo=FALSE}

Outlier(p_formRE$TOT.PROP, method =c("boxplot"), value = FALSE)
```

* Amazons: outliers at row 2, 3, 11, 19

```{r}

(PF_outliers <- p_formRE[c(2,3,11,19),])

```


<font color="darkorchid4">Looks like there are four outlier in the formosa data, but no outliers in the latipinna data.</font>



#### T-tests
I will create a new dataframe without these rows, and test for eye preference and compare variation again.

```{r echo=FALSE}
PFORM_RE <- p_formRE[-c(2,3,11,19),]
```
* t-test for eye preference 
    - Amazons:

```{r echo=FALSE}
t.test(PFORM_RE$TOT.PROP, mu=0.5, alternative = "two.sided")

```

  - Sailfins
  
```{r echo=FALSE}
t.test(p_latRE$TOT.PROP, mu=0.5, alternative = "two.sided")


  #repeat for avg.prop

t.test(p_latRE$AVG.PROP, mu=0.5, alternative = "two.sided")

```

<font color="darkorchid4"> Amazons show left-eye bias, but sailfins show no eye bias.</font>

* comparing species

    - means

```{r echo=FALSE}

t.test(p_latRE$TOT.PROP, PFORM_RE$TOT.PROP)

  #repeat w/avg.prop
t.test(p_latRE$AVG.PROP, PFORM_RE$TOT.PROP)

```

<font color="darkorchid4"> The species don't significantly differ in average eye use.</font>




#### Wilcox tests
Since we're dealing with proportions, I will use Wilcox signed rank and rank sum tests to re-analyze the data

* Tank differences
```{r}
library(curl)

rawTANKS <- curl("https://raw.githubusercontent.com/allisondavis/mirror-exp_wild-pop/master/adavis_mirrorexp-tanks.csv")

rawTANKS <- read.csv(rawTANKS, header = TRUE, sep = ",", stringsAsFactors = TRUE)

wilcox.test(PROP~TANK, data = rawTANKS, paired=TRUE)

FrawTANKS <- rawTANKS[rawTANKS$X.U.FEFF.SPP == "P.form",]
LrawTANKS <- rawTANKS[rawTANKS$X.U.FEFF.SPP == "P.lat", ]

wilcox.test(PROP~TANK, data = FrawTANKS, paired=TRUE, conf.int=TRUE, conf.level=0.95)
wilcox.test(PROP~TANK, data = LrawTANKS, paired=TRUE, conf.int=TRUE, conf.level=0.95)


#want to make sure outliers don't change this; Form outliers: Maeve, Cayenne, Gretchen, Sofia

FrawTANKS_out <- FrawTANKS[-c(3,4,5,6,21,22,37,38),]
wilcox.test(PROP~TANK, data = FrawTANKS_out, paired=TRUE, conf.int=TRUE, conf.level=0.95)

```

<font color="darkorchid4"> No differences between the tanks, so I can analyze with total proportion.</font>


* Eye preference
  - Amazons:

```{r echo=FALSE}

wilcox.test(PFORM_RE$TOT.PROP, mu=0.5, alternative = "two.sided", conf.int=TRUE, conf.level=0.95)
#while median is significant with this test, the CI basically includes 0.5, so this signficance is due more to small sample size rather than true bias 


```

  - Sailfins
  
```{r echo=FALSE}

wilcox.test(p_latRE$TOT.PROP, mu=0.5, alternative = "two.sided", conf.int=TRUE, conf.level=0.95)
#the confidence interval includes the null 0.5, reiterating that they are not significantly biased

  #repeat for avg.prop

wilcox.test(p_latRE$AVG.PROP, mu=0.5, alternative = "two.sided")


```

<font color="darkorchid4"> Amazons still have left-eye bias and sailfins still have no eye bias.</font>

* comparing species

```{r}

raw2 <- rbind(p_latRE, PFORM_RE)

wilcox.test(TOT.PROP~X.U.FEFF.SPP, data = raw2, paired=FALSE, alternative = "two.sided", conf.int=TRUE, conf.level=0.95)
#the confidence interval includes 0, illustrating further a lack of significant difference between the medians

```

<font color="darkorchid4"> Species still don't significantly differ in average eye use.</font>



#### Variance

variances: two-sided (either spp variance greater or less)

```{r echo=FALSE}
var.test(p_latRE$TOT.PROP, PFORM_RE$TOT.PROP, alternative = "two.sided")

    #repeat w/avg.prop

var.test(p_latRE$AVG.PROP, PFORM_RE$TOT.PROP, alternative = "two.sided")

```

- variances: greater (p.lat variance > p.form)

```{r echo=FALSE}
var.test(p_latRE$TOT.PROP, PFORM_RE$TOT.PROP, alternative = "greater")

    #repeat w/avg.prop

var.test(p_latRE$AVG.PROP, PFORM_RE$TOT.PROP, alternative = "greater")

```

- variances: lesser(p.lat variance < p.form)

```{r echo=FALSE}
var.test(p_latRE$TOT.PROP, PFORM_RE$TOT.PROP, alternative = "less")

    #repeat w/avg.prop

var.test(p_latRE$AVG.PROP, PFORM_RE$TOT.PROP, alternative = "less")


```


#### Transformations

Since the preference is a proportion, parametric tests may be the incorrect form of analyses. While there is a non-parametric alternative to the t-test (Wilcox tests), I cannot seem to find an alterantive to the F-test. Upon Mike's suggestion, I'll do an arcsine transformation on the total proportion data. I will then re-run the t-tests and F-tests with this new data.

   * transform the data

```{r}

PL_transA <- transform(p_latRE, arcA = asin(p_latRE$A.PROP))

PF_transA <- transform(PFORM_RE, arcA = asin(PFORM_RE$A.PROP))


PL_transB <- transform(p_latRE, arcB = asin(p_latRE$B.PROP))

PF_transB <- transform(PFORM_RE, arcB = asin(PFORM_RE$B.PROP))


PL_trans <- transform(p_latRE, arcTOT = asin(p_latRE$TOT.PROP))

PF_trans <- transform(PFORM_RE, arcTOT = asin(PFORM_RE$TOT.PROP))

```

  * t-tests: tank differences

```{r}

t.test(PL_transA$arcA, PL_transB$arcB, paired = TRUE, alternative = "two.sided")

t.test(PF_transA$arcA, PF_transB$arcB, paired = TRUE, alternative = "two.sided")


```

<font color="darkorchid4"> Still no differences between the tanks.</font> 
 
  * t-tests: eye preference

```{r}

t.test(PL_trans$TOT.PROP, mu=0.5, alternative = "two.sided")

t.test(PF_trans$TOT.PROP, mu=0.5, alternative = "two.sided")


```

<font color="darkorchid4"> Sailfin still with no significant eye preference, and amazon with significant left-eye bias.</font>

  * t-tests: comparing species

```{r}

t.test(PL_trans$TOT.PROP, PF_trans$TOT.PROP)


```

<font color="darkorchid4"> Still no difference in average eye use between the species.</font>

  * variance:

```{r}

var.test(PL_trans$TOT.PROP, PF_trans$TOT.PROP, alternative = "two.sided")

var.test(PL_trans$TOT.PROP, PF_trans$TOT.PROP, alternative = "greater")

var.test(PL_trans$TOT.PROP, PF_trans$TOT.PROP, alternative = "less")


```

<font color="darkorchid4"> Sailfin still with significantly more variation than amazons.</font>

#### Fisher's exact test

This test can calculate differences in proportion for small sample sizes (n<30). It takes the raw values though, not the proportions. Will need to make a contingency table.

In addition I can perform an exact binomial test to see if the proportions within each species are significantly different than 0.5 (determining eye bias).




rawFISH <- raw[-c(22,23,31,39),]

fisher.test(rawFISH$X.U.FEFF.SPP, rawFISH$TOT.LEFT, alternative = "two.sided", conf.int = TRUE)

fisher.test(rawFISH$X.U.FEFF.SPP, rawFISH$TOT.RIGHT, alternative = "two.sided", conf.int = TRUE)

fisher's test says left eye between species is not significant (nor is right eye), which is what my other tests showed

FRAW <- rawFISH[c(21:40) , c(1,11)]
sum(FRAW$TOT.LEFT, na.rm = TRUE)
binom.test(x=3275, n=9472, p=0.5)

LRAW <- rawFISH[c(1:20) , c(1,11)]
sum(LRAW$TOT.LEFT)
binom.test(x=4511, n=11840, p=0.5)
think I'm doing something wrong here, need to come back to it




#### Kruskal-Wallis

From my understanding, the Kruskal-Wallis test is similar to the Mann Whitney U/Wilcox rank sum test in that it is a non-parametric test using ranks of values to test differences in medians between groups. Only difference (I can see) is that Kruskal is used more when comparing 3+ groups, whereas MWU is for 2 groups.

A squared rank test is a non-parametric version of the F-test (I think), in which it is seeing whether the variance/distribution in rank is different between groups. Does a bunch of pairwise comparisons (need to look up more what that means). Often used as a posthoc test after the null is rejected in a Kruskal-Wallis.

Going to try the Kruskal-Wallis and squared rank test on my non-transformed data.

```{r}
library(PMCMR)

kruskal.test(TOT.PROP~X.U.FEFF.SPP, data = raw2)

posthoc.kruskal.conover.test(TOT.PROP~X.U.FEFF.SPP, data = raw2)


library(conover.test)

conover.test(raw2$TOT.PROP, raw2$X.U.FEFF.SPP, altp = TRUE)

```


<font color="darkorchid4"> Not sure this is giving me what I'm looking for. Seems this p-value is the same as the p-value given with the Mann Whitney U test comparing the species. Don't think this is then testing for differences in variation.</font>


#### Boxplots

<font color="chocolate3">Will create boxplots using both the original, and outlier-removed data</font>

  * Will combine the total preference scores of both original and outlier-removed data into one dataset in order to use ggplot more easily.
  
```{r echo=FALSE}
library(ggplot2)
library(ggsignif)
library(gridExtra)
library(ggthemes)

OG_pref_RE <- rbind(p_latRE, p_formRE)

OR_pref_RE <- rbind(p_latRE, PFORM_RE)

orig <- ggplot(OG_pref_RE, aes(x=X.U.FEFF.SPP, y=TOT.PROP)) + geom_boxplot(outlier.colour = "red", outlier.shape = 8, outlier.size = 2) + xlab("Species") + ylab("Proportion of left-eye bias") + ggtitle("Original Data") + theme_classic()

rem_out <- ggplot(OR_pref_RE, aes(x=X.U.FEFF.SPP, y=TOT.PROP)) + geom_boxplot() + xlab("Species") + ylab("Proportion of left-eye bias") + ggtitle("Outlier-Removed Data") + theme_classic()

rem_out

grid.arrange(orig, rem_out, ncol=2)


```


#### Repeatability

<font color="deepskyblue">Consistency in eye use across trials </font>

Here I will examine if individuals were consistent with their eye preference across the two trials.
  * Since formosa were the only ones w/lateralized vision, this is more pertinent to them
    + if they are lateralized, as clones, they should also be consistent in their lateralization across trials. If they are no consistent, this might mean that the significance we see with their lateralized vision, might just be a statistically chance.
  * would be interesting to see if individuals are still consistent among trials, but overall no spp lateralization for latipinna

I will be using `cor.test(x,y,method="pearson", "kendall", "spearman")`
  * can also add `use="complete.obs"` if I have missing values 
  
  
```{r echo=FALSE}
library(ggpubr)

cor.test(p_latRE$A.PROP, p_latRE$B.PROP, method ="pearson")

cor.test(PFORM_RE$A.PROP, PFORM_RE$B.PROP, method = "pearson")

```

<font color="darkorchid4"> Looks like neither correlation is significant. I will visualize using a scatter plot below.</font>

```{r echo=FALSE}
lat_cor <- ggscatter(p_latRE, x = "A.PROP", y = "B.PROP", add = "reg.line", conf.int = TRUE, cor.coef = TRUE, cor.method = "pearson", xlab = "Eye pref in A tank", ylab = "Eye pref in B tank", title = "Sailfin")


form_cor <- ggscatter(PFORM_RE, x = "A.PROP", y = "B.PROP", add = "reg.line", conf.int = TRUE, cor.coef = TRUE, cor.method = "pearson", xlab = "Eye pref in A tank", ylab = "Eye pref in B tank", title = "Amazon")

grid.arrange(lat_cor, form_cor, ncol=2)

```



<font color="blue"> Correlation implication:</font> With both correlations as insignificant, this means that there was no consistent eye use across trials. 
  * Some form individuals who expressed left eye bias in A did express left eye bias in B, but the degree of bias was not that strong. ***Is there a way to transform data in which I look at whether or not they were left-eye period vs right-eye (like it doesn't matter their actual value, just if it's above 0.5 it's left)? Will this tell me anything differently?***
  
  
* With the LI instead of proportion data

```{r}
library(ggpubr)

cor.test(LAT_rawEX$LI.A, LAT_rawEX$LI.B, method ="pearson")

cor.test(FORM_rawextra$LI.A, FORM_rawextra$LI.B, method = "pearson")


```


```{r echo=FALSE}
lat_cor2 <- ggscatter(LAT_rawEX, x = "LI.A", y = "LI.B", add = "reg.line", conf.int = TRUE, cor.coef = TRUE, cor.method = "pearson", xlab = "Eye pref in A tank", ylab = "Eye pref in B tank", title = "Sailfin")


form_cor2 <- ggscatter(FORM_rawextra, x = "LI.A", y = "LI.B", add = "reg.line", conf.int = TRUE, cor.coef = TRUE, cor.method = "pearson", xlab = "Eye pref in A tank", ylab = "Eye pref in B tank", title = "Amazon")

grid.arrange(lat_cor2, form_cor2, ncol=2)

```


Will try out a Fischer's exact test to test out repeatability of general preference --pearson's correlation looking for the same degree of bias, but I just want to know if they were left in both cases, regardless of how strong that bias was.

Will creat contingency tables with left and right eye use by tank A and B for each species individually. Think I need to create a separate column that denotes whether the bias was left or right, so I'm going to try out an if-else loop.

```{r}

eyeB <- function(x) {
  if (x>0) {
    print("left")
  } else if (x<0) {
    print("right")
  } else
    print("none")
  
}



eyeL <- lapply(LAT_tankEX$LI.TOT, eyeB)
eyeL <- unlist(eyeL)
LAT_tankEX <- cbind(LAT_tankEX, eyeL)
LAT_tankEX


eyeF <- lapply(FORM_tankextra$LI.TOT, eyeB)
eyeF <- unlist(eyeF)
FORM_tankextra <- cbind(FORM_tankextra, eyeF)
FORM_tankextra

```

Now for fischer's test

```{r}

fisher.test(LAT_tankEX$TANK, LAT_tankEX$eyeL, alternative = "two.sided", conf.int = TRUE)

fisher.test(FORM_tankextra$TANK, FORM_tankextra$eyeF, alternative = "two.sided", conf.int = TRUE)

```
  
  
  
  
  
  
