---
title: "FINAL_mirror-exp_wild-pop"
author: "Allison Davis"
date: "November 19, 2019"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Data collection

  * raw data: occurance number and preference score for each individual fish (left, right, NA)
  * pref data: preference scores for tank A, B, combo of A and B, and average of A and B
      - combo score determined as left/(left+right) for total left and right occurances
      - average score determined by averaging tank A pref score and tank B pref score
  * separated all data by species

```{r echo=FALSE}
library(curl)

rawRE <- curl("https://raw.githubusercontent.com/allisondavis/mirror-exp_wild-pop/master/adavis_mirror-exp_wild-pop_rescored-raw.csv")

rawRE <- read.csv(rawRE, header = TRUE, sep = ",", stringsAsFactors = TRUE)

prefRE <- curl("https://raw.githubusercontent.com/allisondavis/mirror-exp_wild-pop/master/adavis_mirror-exp_wild-pop_rescored-prefs.csv")

prefRE <- read.csv(prefRE, header = TRUE, sep = ",", stringsAsFactors = TRUE)


#I will separate out the sexual vs asexual 

p_form.rawRE <- rawRE[rawRE$X.U.FEFF.SPP =="P.form",]

p_lat.rawRE <- rawRE[rawRE$X.U.FEFF.SPP == "P.lat",]

p_formRE <- prefRE[prefRE$X.U.FEFF.SPP== "P.form",]


p_latRE <- prefRE[prefRE$X.U.FEFF.SPP== "P.lat",]

```


#### <font color="deepskyblue">Outlier tests</font>

Histogram shows what appear to be outliers in both species. Will now perform a Tukey's outlier test to see if they are in fact outlier, and if removing these outliers changes the variance between species.

```{r echo=FALSE}

library(DescTools)

Outlier(p_latRE$TOT.PROP, method=c("boxplot"), value = FALSE)
```

* Sailfin: no outliers

```{r echo=FALSE}

Outlier(p_formRE$TOT.PROP, method =c("boxplot"), value = FALSE)
```

* Amazons: outliers at row 2, 3, 11, 19

```{r}

(PF_outliers <- p_formRE[c(2,3,11,19),])

```


<font color="darkorchid4">Looks like there are four outlier in the formosa data, but no outliers in the latipinna data.</font>

#### I will create a new dataframe without these rows, and test for eye preference and compare variation again.

```{r echo=FALSE}
PFORM_RE <- p_formRE[-c(2,3,11,19),]
```
* t-test for eye preference
    - Amazons:

```{r echo=FALSE}
t.test(PFORM_RE$TOT.PROP, mu=0.5, alternative = "two.sided")
```

  - Sailfins
  
```{r echo=FALSE}
t.test(p_latRE$TOT.PROP, mu=0.5, alternative = "two.sided")
```


* comparing species

    - means

```{r echo=FALSE}

t.test(p_latRE$TOT.PROP, PFORM_RE$TOT.PROP)

```

   - variances: two-sided (either spp variance greater or less)

```{r echo=FALSE}
var.test(p_latRE$TOT.PROP, PFORM_RE$TOT.PROP, alternative = "two.sided")
```

- variances: greater (p.lat variance > p.form)

```{r echo=FALSE}
var.test(p_latRE$TOT.PROP, PFORM_RE$TOT.PROP, alternative = "greater")
```

- variances: lesser(p.lat variance < p.form)

```{r echo=FALSE}
var.test(p_latRE$TOT.PROP, PFORM_RE$TOT.PROP, alternative = "less")


```


<font color="firebrick">By removing the outliers, I get significant results for certain tests.</font>

  * <font color="blue">For lateralized vision:</font> the p value is now significant in amazons, and the mean is 0.5182296; this suggests that the amazons are slightly left-eye lateralized for viewing conspecifics.</font>

  * <font color="blue">Sailfins remain non-significant in ther visual lateralization. Additionally, the means of both species do not differ significantly.</font>
  
  * <font color="blue">For variance comparison:</font> by removing the outliers, the results show a higher amount of variation in sailfins as compared to amazons.</font>

#### <font color="chocolate3">Will create boxplots using both the original, and outlier-removed data</font>

  * Will combine the total preference scores of both original and outlier-removed data into one dataset in order to use ggplot more easily.
  
```{r echo=FALSE}
library(ggplot2)
library(ggsignif)
library(gridExtra)
library(ggthemes)

OG_pref_RE <- rbind(p_latRE, p_formRE)

OR_pref_RE <- rbind(p_latRE, PFORM_RE)

orig <- ggplot(OG_pref_RE, aes(x=X.U.FEFF.SPP, y=TOT.PROP)) + geom_boxplot(outlier.colour = "red", outlier.shape = 8, outlier.size = 2) + xlab("Species") + ylab("Proportion of left-eye bias") + ggtitle("Original Data") + theme_classic()

rem_out <- ggplot(OR_pref_RE, aes(x=X.U.FEFF.SPP, y=TOT.PROP)) + geom_boxplot() + xlab("Species") + ylab("Proportion of left-eye bias") + ggtitle("Outlier-Removed Data") + theme_classic()

rem_out

grid.arrange(orig, rem_out, ncol=2)


```