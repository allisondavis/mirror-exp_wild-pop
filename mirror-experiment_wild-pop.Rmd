---
title: "mirror-experiment_wild-pop"
author: "Allison Davis"
date: "August 13, 2019"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# Self inspection/ Mirror experiment

## Overview/Purpose
#### *Purpose*
  Bilateral vision allows organisms to specialize their vision/visual tasks in order to perform more efficiently. Fish use their bilateral vision to more effeciently shoal/school, inspect predators, find food, and mate. In addition to aiding in each individual task, lateralization can help multitask (e.g. feed and watch for predators). 
  The self inspection/mirror experiment test which visual field (left or right) fish prefer to use in the identification/assessment of a **conspecific.** Here we not only tested for difference in preference, but differences in the amount of variation between sexual sailfin mollies and asexual amazon mollies.

#### *General Methods*
  Used two tanks (arbitrarily labled A and B). Long walls of both tanks had acrylic mirror; short walls had white corrugated poster board. Fish were placed in tank for 5min acclimation followed by a 10min swim period, in which we recorded their visual use. 
  Occurances of left or right visual use were determined by scoring every 2sec of video, starting at second 10 and ending at minute 10. This gave 296 occurance values (left, right, or NA for no direct lateralized use). Preference scores calculated as: left/(left+right). 
  A total of 16 Amazon mollies (P. form) and 13 sailfin mollies (P. lat) went through this experiment. *[as of 13 August 2019]*

## Data collection

  * raw data: occurance number and preference score for each individual fish (left, right, NA)
  * pref data: preference scores for tank A, B, combo of A and B, and average of A and B
      - combo score determined as left/(left+right) for total left and right occurances
      - average score determined by averaging tank A pref score and tank B pref score

```{r}
library(curl)

raw <- curl("https://raw.githubusercontent.com/allisondavis/mirror-exp_wild-pop/master/adavis_mirror-exp_wild-pop_raw.csv")

raw <- read.csv(raw, header = TRUE, sep = ",", stringsAsFactors = TRUE)

pref <- curl("https://raw.githubusercontent.com/allisondavis/mirror-exp_wild-pop/master/adavis_mirror-exp_wild-pop_pref-scores.csv")

pref <- read.csv(pref, header = TRUE, sep = ",", stringsAsFactors = TRUE)

head(raw)
head(pref)

#will be focusing on preference scores, so I will separate out the sexual vs asexual only in pref

p_form <- pref[pref$X.U.FEFF.SPP== "P.form",]
head(p_form)

p_lat <- pref[pref$X.U.FEFF.SPP== "P.lat",]
head(p_lat)


```

## Analyses

#### Tank differences

  * Here I look at the variance in preference scores between tank A and tank B to see if there are any tank effects. 
  
```{r}
(vA_lat <- var(p_lat$A.PROP))
(vB_lat <- var(p_lat$B.PROP))
#variances unequal, confirming welch's two-sample t

t.test(p_lat$A.PROP, p_lat$B.PROP)

(vA_form <- var(p_form$A.PROP))
(vB_form <- var(p_form$B.PROP))
#variances unequal, confirming welche's two-sample t

t.test(p_form$A.PROP, p_form$B.PROP)
```

#### Combo vs average
  * I will also test if there is a significant difference in using the combo score vs the averaged score

```{r}

t.test(p_lat$TOT.PROP, p_lat$AVG.PROP)

t.test(p_form$TOT.PROP, p_form$AVG.PROP)

#nope! Appear to be pretty much the same. 

```

#### Eye preference for each species
  * I will look at each species individually to see if they preferencially use their left or right visual field for conspecific/self inspection.

```{r}
#mu is assumed to be 0.5, meaning no eye preference. One-sampled t-test will determine significant deviation from this mean.

t.test(p_lat$TOT.PROP, mu=0.5, alternative = "two.sided")

t.test(p_form$TOT.PROP, mu=0.5, alternative = "two.sided")

```
***NOT SURE HOW TO INTERPRET OR IF THIS IS EVEN THE CORRECT WAY TO TEST? SEE PAPER***

#### Asex vs Sex
  * I will compare the combo score between asexuals (P.form) and sexuals (P.lat) to see how similar/different their eye preference variation is. 

```{r}

hist(p_lat$TOT.PROP)
hist(p_form$TOT.PROP)
```
   
   - Histogram shows that values aren't normally distributed; p_form shows an outlier ***(should I do analyses with and without it?)***

```{r}

t.test(p_lat$TOT.PROP, p_form$TOT.PROP)
```
  
   - T test may not be correct test, as it compares means and not variances. Still, not significant differences. 

   - Will now do F-test: this will compare the variances of the two data sets.

```{r}
#two-sided is predicting that the variances could be either greater or less
var.test(p_lat$TOT.PROP, p_form$TOT.PROP, alternative = "two.sided")

#greater is predicting that variance of p.lat will be greater than p.form
var.test(p_lat$TOT.PROP, p_form$TOT.PROP, alternative = "greater")

#less is predicting that variance of p.lat will be less than p.form
var.test(p_lat$TOT.PROP, p_form$TOT.PROP, alternative = "less")

```
   
   - none show anything significant. 
    
  * Will do an arcsine transformation of data to create a more normal distribution.
    - proportions are limited by range of 0-1; transformation will expand this range. 
    - logit transformation would expand range from -inf to +inf, but if proportions are 0% or 100% could cause inf to show up in analyses (not helpful).
    - arcsine transformation still has a limit (0-pi), but is expanded from original proportion range.

```{r}
#arcsine function

arcsine <- function(p) {
  asin(sqrt(p))
}

#tranformation of scores only
asPL <- arcsine(p_lat$TOT.PROP)
asPF <- arcsine(p_form$TOT.PROP)


#transformation of occurance data then recalculating score
  #first need to sort raw data for species

PL_raw <- raw[raw$X.U.FEFF.SPP == "P.lat",]
PF_raw <- raw[raw$X.U.FEFF.SPP == "P.form",]


PL_raw <- transform(PL_raw, acLeft = arcsine(PL_raw$TOT.LEFT))

```
  
   - this works, in the sense of adding a new column to the existing dataframe with an applied funtion BUT arcsine of any number greater than pi will give a NA (which is what is happening here)